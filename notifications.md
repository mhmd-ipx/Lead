# مستندات سیستم اعلان‌ها (Notification System)

این سند شامل لیست کامل اعلان‌هایی است که باید در رویدادهای مختلف سیستم برای کاربران (پنل ادمین و پنل مالک) ارسال شود.

## انواع اعلان‌ها (Notification Types)
طبق ساختار فرانت‌اند، تایپ‌های زیر برای اعلان‌ها تعریف شده‌اند:
- `system` (اطلاع‌رسانی سیستمی - آبی)
- `payment` (مالی و پرداخت - سبز)
- `support` (پشتیبانی - بنفش)
- `assessment` (ارزیابی - زرد)

---

## لیست اعلان‌های پنل ادمین (Admin Panel)

| عنوان (Title) | نوع (Type) | توضیحات (Description) | لینک اقدام (Action URL) | رویداد (Trigger) |
| :--- | :--- | :--- | :--- | :--- |
| **تیکت پشتیبانی جدید** | `support` | تیکت جدید [شماره تیکت] با موضوع "[موضوع تیکت]" از طرف [نام کاربر] ایجاد شد. | `/admin/support/ticket/:ticketId` | زمانی که کاربر (Owner) یک تیکت جدید ثبت می‌کند. |
| **پاسخ جدید به تیکت** | `support` | پاسخ جدیدی برای تیکت [شماره تیکت] از طرف [نام کاربر] دریافت شد. | `/admin/support/ticket/:ticketId` | زمانی که کاربر (Owner) روی تیکت موجود پاسخی ارسال می‌کند. |
| **تکمیل ارزیابی** | `assessment` | ارزیابی "[نام ارزیابی]" توسط [نام مدیر] تکمیل شد. | `/admin/assessments/:id` | زمانی که ارزیابی توسط مدیر یا کارمند نهایی و ثبت می‌شود. |
| **شروع ارزیابی جدید** | `assessment` | مدیر [نام مدیر] ارزیابی "[نام ارزیابی]" را شروع کرد. | `/admin/companies/:companyId/managers/:managerId` | زمانی که مدیر شروع به پر کردن فرم ارزیابی می‌کند (اولین ذخیره). |
| **ثبت‌نام شرکت جدید** | `system` | شرکت جدید "[نام شرکت]" در سیستم ثبت‌نام کرد. | `/admin/companies/:id` | زمانی که یک کاربر جدید فرآیند ثبت شرکت را تکمیل می‌کند. |
| **درخواست فاکتور رسمی** | `payment` | درخواست صدور فاکتور رسمی برای صورتحساب [شماره صورتحساب] توسط [نام شرکت] ثبت شد. | `/admin/accounting/bills/:id` | زمانی که کاربر درخواست صدور فاکتور رسمی برای یک صورتحساب می‌کند. |
| **پرداخت موفق** | `payment` | پرداخت صورتحساب [شماره صورتحساب] به مبلغ [مبلغ] توسط [نام شرکت] با موفقیت انجام شد. | `/admin/accounting/bills/:id` | زمانی که درگاه پرداخت تایید پرداخت را ارسال می‌کند. |
| **افزودن متقاضی جدید** | `system` | متقاضی جدید [نام متقاضی] به شرکت [نام شرکت] اضافه شد. | `/admin/companies/:companyId/managers` | زمانی که Owner یک متقاضی جدید تعریف می‌کند. |
| **ویرایش اطلاعات شرکت** | `system` | اطلاعات پروفایل شرکت [نام شرکت] ویرایش شد. | `/admin/companies/:id` | زمانی که Owner اطلاعات شرکت خود را ویرایش می‌کند. |

---

## لیست اعلان‌های پنل مالک (Owner Panel)

| عنوان (Title) | نوع (Type) | توضیحات (Description) | لینک اقدام (Action URL) | رویداد (Trigger) |
| :--- | :--- | :--- | :--- | :--- |
| **تایید شرکت** | `system` | ثبت شرکت شما با موفقیت تایید و فعال شد. | `/owner/companies` | زمانی که ادمین وضعیت شرکت را به "active" تغییر می‌دهد. |
| **رد صلاحیت شرکت** | `system` | متاسفانه ثبت شرکت شما تایید نشد. جهت بررسی با پشتیبانی تماس بگیرید. | `/owner/support/create` | زمانی که ادمین وضعیت شرکت را به "inactive" یا "rejected" تغییر می‌دهد. |
| **انتساب ارزیابی جدید** | `assessment` | ارزیابی جدید "[نام ارزیابی]" برای متقاضیان شما فعال شد. | `/owner/managers` | زمانی که ادمین یک ارزیابی را به شرکت یا مدیران آن اختصاص می‌دهد. |
| **تکمیل ارزیابی متقاضی** | `assessment` | ارزیابی [نام متقاضی] تکمیل شد. هم‌اکنون می‌توانید نتایج را مشاهده کنید. | `/owner/managers/:managerId/assessment` | زمانی که متقاضی فرم ارزیابی خود را تکمیل می‌کند. |
| **نتیجه آزمون آماده شد** | `assessment` | نتیجه آزمون "[نام آزمون]" برای [نام متقاضی] آماده مشاهده است. | `/owner/exams/results/${examId}` | زمانی که پاسخ‌نامه آزمون تصحیح و نمره نهایی ثبت می‌شود. |
| **صدور صورتحساب جدید** | `payment` | صورتحساب جدیدی با شماره [شماره صورتحساب] به مبلغ [مبلغ] برای شما صادر شد. | `/owner/accounting/bills/:id` | زمانی که ادمین یا سیستم یک صورتحساب جدید برای شرکت صادر می‌کند. |
| **تایید پرداخت** | `payment` | پرداخت صورتحساب [شماره صورتحساب] با موفقیت تایید شد. | `/owner/accounting/bills/:id` | زمانی که وضعیت صورتحساب به "paid" تغییر می‌کند. |
| **صدور فاکتور رسمی** | `payment` | فاکتور رسمی درخواست شده برای صورتحساب [شماره صورتحساب] صادر شد. | `/owner/accounting/bills/:id` | زمانی که ادمین فایل فاکتور رسمی را آپلود و تایید می‌کند. |
| **پاسخ پشتیبانی** | `support` | کارشناس پشتیبانی به تیکت [شماره تیکت] پاسخ داد. | `/owner/support/ticket/:ticketId` | زمانی که ادمین روی تیکت کاربر پاسخی ثبت می‌کند. |
| **تغییر وضعیت تیکت** | `support` | وضعیت تیکت [شماره تیکت] به "[وضعیت جدید]" تغییر کرد. | `/owner/support/ticket/:ticketId` | زمانی که ادمین وضعیت تیکت را تغییر می‌دهد (مثلاً بسته می‌شود). |
| **فعال‌سازی آزمون** | `assessment` | آزمون "[نام آزمون]" برای شرکت شما فعال شد. | `/owner/exams` | زمانی که ادمین یک آزمون را برای مدیران این شرکت فعال می‌کند. |
| **یادآوری پرداخت** | `payment` | یادآوری: مهلت پرداخت صورتحساب [شماره صورتحساب] رو به اتمام است. | `/owner/accounting/bills/:id` | (Job) سیستم به صورت خودکار ۳ روز مانده به سررسید ارسال می‌کند. |
| **خوش‌آمدگویی** | `system` | به پلتفرم لید خوش آمدید. برای شروع، اطلاعات شرکت خود را تکمیل کنید. | `/owner/companies/add` | بلافاصله پس از ثبت‌نام اولیه کاربر. |

---

## نکات فنی برای پیاده‌سازی (Backend Developer)
1. **فرمت لینک‌ها**: لینک‌ها باید دقیقاً مطابق ساختار فوق باشند. پارامترهایی مثل `:id`، `:ticketId`، `:companyId` و `:managerId` باید با شناسه واقعی رکورد در دیتابیس جایگزین شوند.
2. **مدیریت وضعیت**: فیلد `is_read` به صورت پیش‌فرض `false` است. سرویس `POST /notifications/:id/read` برای تغییر این وضعیت استفاده می‌شود.
3. **زمان**: فیلد `created_at` باید زمان دقیق وقوع رخداد (UTC یا سرور تایم) باشد که در فرانت‌اند به فرمت کاربر (شمسی) نمایش داده می‌شود.
4. **Push Notification**: در صورت امکان، علاوه بر ذخیره در دیتابیس، از طریق سوکت یا مکانیزم‌های دیگر، نوتیفیکیشن به صورت آنی (Real-time) به کلاینت کاربر آنلاین ارسال شود.
5. **ارسال ایمیل/پیامک**: برخی از این ناتیفیکیشن‌ها (مانند پرداخت، تیکت و ثبت‌نام) می‌توانند همزمان منجر به ارسال ایمیل یا پیامک نیز بشوند (تنظیمات این بخش جداگانه است).
